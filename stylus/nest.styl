// Spacing Reset

$box-sizing
  box-sizing border-box
  
$spacing
  margin-bottom 0
  &:first-child
    margin-top 0 !important

* 
  @extend $box-sizing
  @extend $spacing
  &:before
  &:after
    @extend $box-sizing

body
  margin 0

// Nest Generator

prefix   = "nest"
unit     = vw
dev      = false
devColor = teal
devUnits = false

nest(ratio, shift = 0, steps = 6, bg)

  class      = '.' + prefix + ' '
  class_list = class
  for step in (1...steps + 1)
    rank = steps - (step - shift)
    size = (ratio**rank)
    size = round(size,3)
    unless step is 1
      class_list += class
    
    {class_list}
      &.padded
        padding (size)em
      
      if dev
        background-color rgba(bg, 0.2)
        outline 1px solid rgba(bg, 0.75)
        if devUnits
          &:before
            if size == 1
              color red
            else
              color black
            content "" + size
            display inline-block
            line-height 0.65
            margin-bottom size

      // Adjust spacing size for children
      rank = steps - ((step + 1) - shift)
      size = (ratio**rank)
      size = round(size,3)
      
      *
        margin-top (size)em
        margin-top (size)rem

      .grid.spaced
        border-spacing (size)em 0
        margin (size)em (-(size)em) 0

nest(1.5, -2.5, 6, devColor)